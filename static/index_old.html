<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Church Meeting</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script src="https://unpkg.com/simple-peer@9.11.0/simplepeer.min.js"></script>
    <script src="https://unpkg.com/recordrtc@5.6.2/RecordRTC.js"></script>
</head>
<body>
    <!-- Join/Create Meeting Section -->
    <div id="joinSection" class="join-container">
        <div class="join-card">
            <div class="join-header">
                <h1>🎥 Online Church Meeting</h1>
                <p class="subtitle">Only for Prayer Meeting</p>
            </div>
            <div class="join-form">
                <div class="input-group">
                    <label for="usernameInput">Your Name</label>
                    <input
                        type="text"
                        id="usernameInput"
                        placeholder="Enter your name"
                        maxlength="50"
                        required
                    >
                </div>
                <div class="input-group">
                    <label for="meetingIdInput">Meeting ID (optional)</label>
                    <input
                        type="text"
                        id="meetingIdInput"
                        placeholder="Leave blank to create new meeting"
                        maxlength="8"
                    >
                </div>
                <div class="button-group">
                    <button id="createMeetingBtn" class="btn btn-primary">
                        <span class="btn-icon">➕</span>
                        Create New Meeting
                    </button>
                    <button id="joinMeetingBtn" class="btn btn-success">
                        <span class="btn-icon">🚪</span>
                        Join Meeting
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Meeting Room Section -->
    <div id="meetingSection" class="meeting-container hidden">
        <!-- Top Navigation Bar -->
        <div class="top-nav">
            <div class="nav-left">
                <div class="meeting-title">
                    <span class="meeting-icon">🎥</span>
                    <span id="navMeetingTitle">Online Church Meeting</span>
                </div>
                <div class="meeting-id-display">
                    <span class="id-label">ID:</span>
                    <span id="navMeetingId"></span>
                </div>
            </div>
            <div class="nav-center">
                <div class="meeting-timer" id="meetingTimer">00:00:00</div>
                <div class="meeting-date" id="meetingDate"></div>
            </div>
            <div class="nav-right">
                <div class="participant-indicator">
                    <span class="participant-icon">👥</span>
                    <span id="navParticipantCount">1</span>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Video Area -->
            <div class="video-area">
                <!-- View Toggle -->
                <div class="view-controls">
                    <button id="gridViewBtn" class="view-btn active" title="Grid View">
                        <span class="view-icon">⊞</span> Grid
                    </button>
                    <button id="speakerViewBtn" class="view-btn" title="Speaker View">
                        <span class="view-icon">▭</span> Speaker
                    </button>
                </div>

                <!-- Video Grid -->
                <div id="videoGrid" class="video-grid grid-view">
                    <!-- Videos will be added here dynamically -->
                </div>

                <!-- Reactions Overlay -->
                <div id="reactionsOverlay" class="reactions-overlay"></div>
            </div>

            <!-- Chat Panel -->
            <div id="chatPanel" class="chat-panel">
                <div class="chat-header">
                    <h3>Chat</h3>
                    <button id="closeChatBtn" class="close-chat-btn" title="Close Chat">✕</button>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-empty">No messages yet. Start the conversation!</div>
                </div>
                <div class="chat-input-container">
                    <input
                        type="text"
                        id="chatInput"
                        placeholder="Type a message..."
                        maxlength="500"
                    >
                    <button id="sendChatBtn" class="send-chat-btn" title="Send Message">
                        <span class="send-icon">➤</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Control Bar -->
        <div class="bottom-controls">
            <div class="controls-left">
                <div class="meeting-info-small">
                    <span id="bottomMeetingTime">00:00</span>
                </div>
            </div>

            <div class="controls-center">
                <button id="toggleAudioBtn" class="control-btn" title="Microphone">
                    <span class="control-icon">🎤</span>
                    <span class="control-label">Mute</span>
                </button>

                <button id="toggleVideoBtn" class="control-btn" title="Camera">
                    <span class="control-icon">📹</span>
                    <span class="control-label">Stop Video</span>
                </button>

                <button id="toggleChatBtn" class="control-btn" title="Chat">
                    <span class="control-icon">💬</span>
                    <span class="control-label">Chat</span>
                    <span id="unreadBadge" class="unread-badge hidden">0</span>
                </button>

                <button id="reactionsBtn" class="control-btn" title="Reactions">
                    <span class="control-icon">😊</span>
                    <span class="control-label">React</span>
                </button>

                <button id="recordBtn" class="control-btn" title="Record">
                    <span class="control-icon">⏺️</span>
                    <span class="control-label">Record</span>
                </button>

                <button id="moreOptionsBtn" class="control-btn" title="More Options">
                    <span class="control-icon">⋮</span>
                    <span class="control-label">More</span>
                </button>

                <button id="leaveMeetingBtn" class="control-btn leave-btn" title="Leave Meeting">
                    <span class="control-icon">📞</span>
                    <span class="control-label">Leave</span>
                </button>
            </div>

            <div class="controls-right">
                <!-- Placeholder for future features -->
            </div>
        </div>

        <!-- Reactions Picker Popup -->
        <div id="reactionsPicker" class="reactions-picker hidden">
            <button class="reaction-emoji" data-emoji="👍">👍</button>
            <button class="reaction-emoji" data-emoji="❤️">❤️</button>
            <button class="reaction-emoji" data-emoji="😂">😂</button>
            <button class="reaction-emoji" data-emoji="👏">👏</button>
            <button class="reaction-emoji" data-emoji="🎉">🎉</button>
            <button class="reaction-emoji" data-emoji="🔥">🔥</button>
        </div>

        <!-- More Options Menu -->
        <div id="moreOptionsMenu" class="more-options-menu hidden">
            <button id="shareScreenBtn" class="menu-item">
                <span class="menu-icon">🖥️</span>
                Share Screen
            </button>
            <button id="copyLinkBtn" class="menu-item">
                <span class="menu-icon">🔗</span>
                Copy Meeting Link
            </button>
            <div class="menu-divider"></div>
            <button id="settingsBtn" class="menu-item">
                <span class="menu-icon">⚙️</span>
                Settings
            </button>
        </div>
    </div>

    <!-- Status Messages -->
    <div id="statusMessage" class="status-message hidden"></div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner hidden">
        <div class="spinner"></div>
        <p>Connecting to meeting...</p>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>

